<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wonderkid</title>
    <!-- Rive Runtime -->
    <script src="https://unpkg.com/@rive-app/canvas@2.7.0"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #FFF9F5;
        }
        .footer {
            position: fixed;
            bottom: 0px;
            left: 0px;
            right: 0px;
            margin-bottom: 2rem;
            background-color: transparent;
            width: 100%;
            text-align: center;
        }
        .rive-container-neko {
            width: 100%;
            max-width: 1000px;
            height: 100%;
            max-height: 1000px;
            position: fixed;
            bottom: 0;
            right: -10px;
            background-color: transparent;
            overflow: visible;
        }
        .rive-container-luna {
            width: 100%;
            max-width: 1000px;
            height: 100%;
            max-height: 1000px;
            position: fixed;
            bottom: 0;
            left: -10px;
            background-color: transparent;
            overflow: visible;
            transform: scaleX(-1); /* Flip horizontally */
        }
        .logo-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: fixed;
            top: 40%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: transparent;
            overflow: visible;
            z-index: 100; /* Ensure logo appears above other elements */
            width: 100%;
            max-width: 450px;
        }
        .logo {
            width: 100%;
            height: auto;
            display: block;
            object-fit: contain;
        }
        .store-button {
            display: flex;
            flex-direction: row;
            gap: 20px;
            margin-top: 20px;
            justify-content: center;
            align-items: center;
            width: 100%;
            flex-wrap: wrap;
        }
        .store-button-container {
            display: flex;
            background-color: #393939;
            flex-direction: row;
            gap: 20px;
            margin-top: 20px;
            justify-content: center;
            align-items: center;
        }
        #rive-canvas-neko {
            width: 100%;
            height: 100%;
            display: block;
        }
        #rive-canvas-luna {
            width: 100%;
            height: 100%;
            display: block;
        }
        #app-store-badge, #play-store-badge {
            width: 200px;
            max-width: 45%;
            height: auto;
        }

        /* Media Queries for Responsive Design */
        @media (max-width: 768px) {
            .rive-container-neko, .rive-container-luna {
                bottom: -80px;
            }
            .logo-container {
                top: 20%;
                max-width: 250px;
            }
            .store-button {
                flex-direction: column;
            }
            .footer {
                margin-bottom: 1rem;
            }
        }

        /* @media (max-width: 480px) {
            .rive-container-neko, .rive-container-luna {
                height: 100vh;
                top: 20vh;
            }
            .logo-container {
                top: 50%;
                max-width: 250px;
            }
            .store-button {
                gap: 10px;
            }
            #app-store-badge, #play-store-badge {
                width: 120px;
            }
        } */
    </style>
</head>
<body>
    <!-- Rive Animation Container -->
    <div class="rive-container-neko">
        <canvas id="rive-canvas-neko"></canvas>
    </div>

    <div class="logo-container">
        <img src="/static/images/logo.png" class="logo">
    </div>

    <div class="rive-container-luna">
        <canvas id="rive-canvas-luna"></canvas>
    </div>

    <div class="footer">
        <div href="#" class="store-button">
            <!-- <div class="store-button-container">
                <img src="/static/images/apple.png" style="width: 100px; height: 100px;">
            </div> -->
            <img src="/static/images/app-store-badge.png" id="app-store-badge" alt="Download on App Store">
            <img src="/static/images/play-store-badge.png" id="play-store-badge" alt="Get it on Google Play">
        </div>
    </div>

    <script>
        // Wait for the DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Handle high-DPI displays
            const canvasNeko = document.getElementById('rive-canvas-neko');
            const ctxNeko = canvasNeko.getContext('2d');
            const dprNeko = Math.min(window.devicePixelRatio, 1);

            const canvasLuna = document.getElementById('rive-canvas-luna');
            const ctxLuna = canvasLuna.getContext('2d');
            const dprLuna = Math.min(window.devicePixelRatio, 1);
            
            // Set canvas dimensions properly for high-DPI display
            function resizeCanvas(canvas, ctx, dpr) {
                const rect = canvas.getBoundingClientRect();
                canvas.width = rect.width * dpr;
                canvas.height = rect.height * dpr; 
                ctx.scale(dpr, dpr);

                console.log('dpr:', dpr);
            }
            
            // Call resize initially and on window resize
            resizeCanvas(canvasNeko, ctxNeko, dprNeko);
            resizeCanvas(canvasLuna, ctxLuna, dprLuna);
            window.addEventListener('resize', () => {
                resizeCanvas(canvasNeko, ctxNeko, dprNeko);
                resizeCanvas(canvasLuna, ctxLuna, dprLuna);
            });
            
            // Local Rive animation file path
            const riveFile = '/static/anim/robots.riv';
            let riveInstanceNeko = null;
            let riveInstanceLuna = null;
            
            // Initialize Rive with fit options
            riveInstanceNeko = new rive.Rive({
                src: riveFile,
                canvas: canvasNeko,
                autoplay: true,
                artboard: 'NekoParentLogin',
                stateMachines: 'ParentLoginState',
                fit: rive.Fit.cover,
                alignment: rive.Alignment.Center,
                onLoad: () => {
                    console.log('Rive animation loaded successfully');
                    
                    // Log available artboards for debugging
                    if (riveInstanceNeko.artboardNames) {
                        console.log('Available artboards:', riveInstanceNeko.artboardNames);
                    }
                    
                    // Log available state machines and inputs for debugging
                    if (riveInstanceNeko.stateMachineNames) {
                        console.log('Available state machines:', riveInstanceNeko.stateMachineNames);
                        
                        // Get inputs for the state machine
                        const inputs = riveInstanceNeko.stateMachineInputs('ParentLoginState');
                        console.log('State machine inputs:', inputs);
                        
                        // Try to fire the peek trigger after a short delay
                        setTimeout(() => {
                            try {
                                const peekTrigger = inputs.find(input => input.name === 'peek');
                                if (peekTrigger) {
                                    peekTrigger.fire();
                                    console.log('Peek trigger fired successfully');
                                } else {
                                    console.warn('Peek trigger not found in inputs');
                                }
                            } catch (err) {
                                console.error('Error firing peek trigger:', err);
                            }
                        }, 1000);
                    }
                },
                onError: (err) => {
                    console.error('Error loading Rive animation:', err);
                }
            });

            riveInstanceLuna = new rive.Rive({
                src: riveFile,
                canvas: canvasLuna,
                autoplay: true,
                artboard: 'LunaParentLogin',
                stateMachines: 'ParentLoginState',
                fit: rive.Fit.cover,
                alignment: rive.Alignment.Center,
                onLoad: () => {
                    console.log('Rive animation loaded successfully');
                    
                    // Log available artboards for debugging
                    if (riveInstanceLuna.artboardNames) {
                        console.log('Available artboards:', riveInstanceLuna.artboardNames);
                    }
                    
                    // Log available state machines and inputs for debugging
                    if (riveInstanceLuna.stateMachineNames) {
                        console.log('Available state machines:', riveInstanceLuna.stateMachineNames);
                        
                        // Get inputs for the state machine
                        const inputs = riveInstanceLuna.stateMachineInputs('ParentLoginState');
                        console.log('State machine inputs:', inputs);
                        
                        // Try to fire the peek trigger after a short delay
                        setTimeout(() => {
                            try {
                                const peekTrigger = inputs.find(input => input.name === 'peek');
                                if (peekTrigger) {
                                    peekTrigger.fire();
                                    console.log('Peek trigger fired successfully');
                                } else {
                                    console.warn('Peek trigger not found in inputs');
                                }
                            } catch (err) {
                                console.error('Error firing peek trigger:', err);
                            }
                        }, 1000);
                    }
                },
                onError: (err) => {
                    console.error('Error loading Rive animation:', err);
                }
            });
            
            // Function to trigger Rive inputs programmatically
            function triggerRiveInput(triggerName) {
                if (riveInstance && riveInstance.stateMachineInputs) {
                    try {
                        const inputs = riveInstance.stateMachineInputs('ParentLoginState');
                        const trigger = inputs.find(input => input.name === triggerName);
                        
                        if (trigger) {
                            trigger.fire();
                            console.log(`Trigger fired: ${triggerName}`);
                            return true;
                        } else {
                            console.warn(`Trigger ${triggerName} not found in inputs`);
                            return false;
                        }
                    } catch (err) {
                        console.error(`Error firing trigger ${triggerName}:`, err);
                        return false;
                    }
                }
                return false;
            }
            
            // Make the function available globally
            window.triggerRiveInput = triggerRiveInput;
        });
    </script>
</body>
</html> 